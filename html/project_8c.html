<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>ECE 4760 Final Project: src/project.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ECE 4760 Final Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">project.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;inttypes.h&gt;</code><br />
<code>#include &lt;avr/io.h&gt;</code><br />
<code>#include &lt;avr/interrupt.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &quot;<a class="el" href="imu_8h_source.html">imu.h</a>&quot;</code><br />
<code>#include &lt;util/delay.h&gt;</code><br />
<code>#include &quot;<a class="el" href="midi_8h_source.html">midi.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="uart_8h_source.html">uart.h</a>&quot;</code><br />
</div>
<p><a href="project_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a65f7891fccbfcf7d08964555630773b3"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>&#160;&#160;&#160;25</td></tr>
<tr class="separator:a65f7891fccbfcf7d08964555630773b3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a667e4a328965fc2fc25f1533a00ec89f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a667e4a328965fc2fc25f1533a00ec89f">WAIT_VALUE</a>&#160;&#160;&#160;(300 / <a class="el" href="project_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)</td></tr>
<tr class="separator:a667e4a328965fc2fc25f1533a00ec89f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab4df97ec55e2ff0a866d4681bf326a40"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#ab4df97ec55e2ff0a866d4681bf326a40">RATE_THRES</a>&#160;&#160;&#160;(240)</td></tr>
<tr class="separator:ab4df97ec55e2ff0a866d4681bf326a40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ab55078d807df0a75af8a2fa8eefdcc41"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#ab55078d807df0a75af8a2fa8eefdcc41">task1</a> (void)</td></tr>
<tr class="memdesc:ab55078d807df0a75af8a2fa8eefdcc41"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function is the function that gets called every 25ms that handles the main logic, it reads the sensor values, checks flags set by the ADC interrupt vector, and sends the according MIDI signals.  <a href="#ab55078d807df0a75af8a2fa8eefdcc41">More...</a><br /></td></tr>
<tr class="separator:ab55078d807df0a75af8a2fa8eefdcc41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9efe22aaead3a5e936b5df459de02eba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a9efe22aaead3a5e936b5df459de02eba">initialize</a> (void)</td></tr>
<tr class="separator:a9efe22aaead3a5e936b5df459de02eba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe65b6407e326820d3a507f8ba85367f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#abe65b6407e326820d3a507f8ba85367f">get_pitch_roll</a> (float *pitch, float *roll)</td></tr>
<tr class="memdesc:abe65b6407e326820d3a507f8ba85367f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function reads the accelerometer and calculates the pitch and roll of the device.  <a href="#abe65b6407e326820d3a507f8ba85367f">More...</a><br /></td></tr>
<tr class="separator:abe65b6407e326820d3a507f8ba85367f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35c74421f01d5b088b0919fe9fe4abd0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a35c74421f01d5b088b0919fe9fe4abd0">play_note_off</a> (void)</td></tr>
<tr class="memdesc:a35c74421f01d5b088b0919fe9fe4abd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Turns the note we had stored in the note global varible off.  <a href="#a35c74421f01d5b088b0919fe9fe4abd0">More...</a><br /></td></tr>
<tr class="separator:a35c74421f01d5b088b0919fe9fe4abd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeebc67746187224a86dcf54613f612b5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#aeebc67746187224a86dcf54613f612b5">play_note_on</a> (uint8_t n)</td></tr>
<tr class="memdesc:aeebc67746187224a86dcf54613f612b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sends the MIDI note on signal on the serial line with the note specified in the parameter at velocity 100. stores the note in a global variable so we can turn it off at a later time.  <a href="#aeebc67746187224a86dcf54613f612b5">More...</a><br /></td></tr>
<tr class="separator:aeebc67746187224a86dcf54613f612b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec43762dc86e029b395d4e5819192c2d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#aec43762dc86e029b395d4e5819192c2d">ISR</a> (TIMER0_COMPA_vect)</td></tr>
<tr class="memdesc:aec43762dc86e029b395d4e5819192c2d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This ISR keeps a millisecond timer for timing the main task.  <a href="#aec43762dc86e029b395d4e5819192c2d">More...</a><br /></td></tr>
<tr class="separator:aec43762dc86e029b395d4e5819192c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840291bc02cba5474a4cb46a9b9566fe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a> (void)</td></tr>
<tr class="separator:a840291bc02cba5474a4cb46a9b9566fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05c2e5b588ced1cd7312f5b0edc5b295"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a05c2e5b588ced1cd7312f5b0edc5b295">ISR</a> (ADC_vect)</td></tr>
<tr class="memdesc:a05c2e5b588ced1cd7312f5b0edc5b295"><td class="mdescLeft">&#160;</td><td class="mdescRight">Rather than waiting in while loop for the ADC readings, we use the ADC interupt that sets the values asynchronously. This function checks to see if the values of the flex resistors have indicted whether a finger has been bent or not. If the value of Chanel 0 of the ADC is greater than 250 we set a flag to play a note, if it is less than 245, we set a flag to end the note. The other flex resitor, on the middle finger has a larger range so determining whether it is on or off is easier, we merely check to see if it is greater than 240, and set the appropiate flag.  <a href="#a05c2e5b588ced1cd7312f5b0edc5b295">More...</a><br /></td></tr>
<tr class="separator:a05c2e5b588ced1cd7312f5b0edc5b295"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ef6c44503e9e5e255ef3c7847c7f7ad"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a4ef6c44503e9e5e255ef3c7847c7f7ad">handle_notes</a> (float roll)</td></tr>
<tr class="memdesc:a4ef6c44503e9e5e255ef3c7847c7f7ad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes the current roll and determines if a note needs to be played or turned off. It calculates the note from the roll. We are playing notes only on a major scale. It can be transposed up or down.  <a href="#a4ef6c44503e9e5e255ef3c7847c7f7ad">More...</a><br /></td></tr>
<tr class="separator:a4ef6c44503e9e5e255ef3c7847c7f7ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a14798c028401767ed27eed7a06030295"><td class="memItemLeft" align="right" valign="top">FILE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a14798c028401767ed27eed7a06030295">uart_str</a> = FDEV_SETUP_STREAM(<a class="el" href="uart_8h.html#a985ba70f2a53d95f1fd11f70f1d8f4f6">uart_putchar</a>, <a class="el" href="uart_8h.html#ae29d6eea5f2e7997551b4acb64082d8e">uart_getchar</a>, _FDEV_SETUP_RW)</td></tr>
<tr class="separator:a14798c028401767ed27eed7a06030295"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a106c21f35394486c40bed04ae4aaa2"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a1a106c21f35394486c40bed04ae4aaa2">play_on</a> = 0</td></tr>
<tr class="memdesc:a1a106c21f35394486c40bed04ae4aaa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">if 1 a note is played  <a href="#a1a106c21f35394486c40bed04ae4aaa2">More...</a><br /></td></tr>
<tr class="separator:a1a106c21f35394486c40bed04ae4aaa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2870b94aac38e021ccd11ec0bc3b3952"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a2870b94aac38e021ccd11ec0bc3b3952">play_off</a> = 0</td></tr>
<tr class="memdesc:a2870b94aac38e021ccd11ec0bc3b3952"><td class="mdescLeft">&#160;</td><td class="mdescRight">if 0 a note is turned off  <a href="#a2870b94aac38e021ccd11ec0bc3b3952">More...</a><br /></td></tr>
<tr class="separator:a2870b94aac38e021ccd11ec0bc3b3952"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf5dc5d7c17abd6f7cd1c83d7bf7b80b"><td class="memItemLeft" align="right" valign="top">volatile char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#adf5dc5d7c17abd6f7cd1c83d7bf7b80b">chan1</a></td></tr>
<tr class="separator:adf5dc5d7c17abd6f7cd1c83d7bf7b80b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b4b739b9230f7463316669ac39ddbed"><td class="memItemLeft" align="right" valign="top">volatile char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a4b4b739b9230f7463316669ac39ddbed">adc_chan1_on</a></td></tr>
<tr class="memdesc:a4b4b739b9230f7463316669ac39ddbed"><td class="mdescLeft">&#160;</td><td class="mdescRight">whether or not the middle note is held down.  <a href="#a4b4b739b9230f7463316669ac39ddbed">More...</a><br /></td></tr>
<tr class="separator:a4b4b739b9230f7463316669ac39ddbed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a059effc655ee0c23238a50c5ae5369cb"><td class="memItemLeft" align="right" valign="top">volatile unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a059effc655ee0c23238a50c5ae5369cb">time1</a></td></tr>
<tr class="memdesc:a059effc655ee0c23238a50c5ae5369cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">task1 counter  <a href="#a059effc655ee0c23238a50c5ae5369cb">More...</a><br /></td></tr>
<tr class="separator:a059effc655ee0c23238a50c5ae5369cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abd7697134589aaeaa645826770a848dd"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#abd7697134589aaeaa645826770a848dd">channel</a> = 0</td></tr>
<tr class="separator:abd7697134589aaeaa645826770a848dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef35889f75ea54ee11bb86aa6e050fd"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a6ef35889f75ea54ee11bb86aa6e050fd">instrument</a> = 0</td></tr>
<tr class="memdesc:a6ef35889f75ea54ee11bb86aa6e050fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">counter to keep track of what instrument is on the MIDI channel  <a href="#a6ef35889f75ea54ee11bb86aa6e050fd">More...</a><br /></td></tr>
<tr class="separator:a6ef35889f75ea54ee11bb86aa6e050fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c8d1e48e7d9348b930a7e7bc4d610a1"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a7c8d1e48e7d9348b930a7e7bc4d610a1">note</a> = 60</td></tr>
<tr class="memdesc:a7c8d1e48e7d9348b930a7e7bc4d610a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current note being played.  <a href="#a7c8d1e48e7d9348b930a7e7bc4d610a1">More...</a><br /></td></tr>
<tr class="separator:a7c8d1e48e7d9348b930a7e7bc4d610a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a738c7d0b67ff439a2c81556a6e27a0b1"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a738c7d0b67ff439a2c81556a6e27a0b1">base_note</a> = 0</td></tr>
<tr class="memdesc:a738c7d0b67ff439a2c81556a6e27a0b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">base_note for transposing the C-major scale  <a href="#a738c7d0b67ff439a2c81556a6e27a0b1">More...</a><br /></td></tr>
<tr class="separator:a738c7d0b67ff439a2c81556a6e27a0b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93658cf9f03a3303cdb292e655c657e7"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a93658cf9f03a3303cdb292e655c657e7">time</a> = 0</td></tr>
<tr class="separator:a93658cf9f03a3303cdb292e655c657e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff3f4500e2ca9497ec093a0e2d69e7e9"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a> = <a class="el" href="project_8c.html#a667e4a328965fc2fc25f1533a00ec89f">WAIT_VALUE</a></td></tr>
<tr class="separator:aff3f4500e2ca9497ec093a0e2d69e7e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99e594c637ddc152c7bdd011c3e3230a"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#a99e594c637ddc152c7bdd011c3e3230a">old_roll</a></td></tr>
<tr class="memdesc:a99e594c637ddc152c7bdd011c3e3230a"><td class="mdescLeft">&#160;</td><td class="mdescRight">used to keep track of the roll so we can bend the pitch relative to the note it was played at.  <a href="#a99e594c637ddc152c7bdd011c3e3230a">More...</a><br /></td></tr>
<tr class="separator:a99e594c637ddc152c7bdd011c3e3230a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac11cb4dad0b6ed87a539bacb6d2199ab"><td class="memItemLeft" align="right" valign="top">char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="project_8c.html#ac11cb4dad0b6ed87a539bacb6d2199ab">cmajor</a> [15] = {48, 50, 52, 53, 55, 57, 59, 60, 62, 64, 65, 67, 69, 71, 72}</td></tr>
<tr class="memdesc:ac11cb4dad0b6ed87a539bacb6d2199ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">C-major scale in MIDI notes can add or subtract a value to transpose to different keys.  <a href="#ac11cb4dad0b6ed87a539bacb6d2199ab">More...</a><br /></td></tr>
<tr class="separator:ac11cb4dad0b6ed87a539bacb6d2199ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ab4df97ec55e2ff0a866d4681bf326a40"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RATE_THRES&#160;&#160;&#160;(240)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project_8c_source.html#l00145">145</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a65f7891fccbfcf7d08964555630773b3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define t1&#160;&#160;&#160;25</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project_8c_source.html#l00018">18</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a667e4a328965fc2fc25f1533a00ec89f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define WAIT_VALUE&#160;&#160;&#160;(300 / <a class="el" href="project_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project_8c_source.html#l00144">144</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="abe65b6407e326820d3a507f8ba85367f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_pitch_roll </td>
          <td>(</td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>pitch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float *&#160;</td>
          <td class="paramname"><em>roll</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function reads the accelerometer and calculates the pitch and roll of the device. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pitch</td><td>pointer to a float that will contain the current pitch measured by the accelerometer. </td></tr>
    <tr><td class="paramname">roll</td><td>pointer to a float that will contain the current roll measured by the accelerometer. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="project_8c_source.html#l00120">120</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4ef6c44503e9e5e255ef3c7847c7f7ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char handle_notes </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>roll</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes the current roll and determines if a note needs to be played or turned off. It calculates the note from the roll. We are playing notes only on a major scale. It can be transposed up or down. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">roll</td><td>- roll of the glove</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 if a new note was played, 0 otherwise </dd></dl>

<p>Definition at line <a class="el" href="project_8c_source.html#l00211">211</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a9efe22aaead3a5e936b5df459de02eba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initialize </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project_8c_source.html#l00261">261</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="aec43762dc86e029b395d4e5819192c2d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">TIMER0_COMPA_vect&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This ISR keeps a millisecond timer for timing the main task. </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00050">50</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a05c2e5b588ced1cd7312f5b0edc5b295"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ISR </td>
          <td>(</td>
          <td class="paramtype">ADC_vect&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Rather than waiting in while loop for the ADC readings, we use the ADC interupt that sets the values asynchronously. This function checks to see if the values of the flex resistors have indicted whether a finger has been bent or not. If the value of Chanel 0 of the ADC is greater than 250 we set a flag to play a note, if it is less than 245, we set a flag to end the note. The other flex resitor, on the middle finger has a larger range so determining whether it is on or off is easier, we merely check to see if it is greater than 240, and set the appropiate flag. </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00081">81</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a840291bc02cba5474a4cb46a9b9566fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Entry point and task scheduler loop </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00062">62</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a35c74421f01d5b088b0919fe9fe4abd0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void play_note_off </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Turns the note we had stored in the note global varible off. </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00253">253</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="aeebc67746187224a86dcf54613f612b5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void play_note_on </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>n</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sends the MIDI note on signal on the serial line with the note specified in the parameter at velocity 100. stores the note in a global variable so we can turn it off at a later time. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">n</td><td>- note to play. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="project_8c_source.html#l00243">243</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab55078d807df0a75af8a2fa8eefdcc41"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void task1 </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is the function that gets called every 25ms that handles the main logic, it reads the sensor values, checks flags set by the ADC interrupt vector, and sends the according MIDI signals. </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00159">159</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a4b4b739b9230f7463316669ac39ddbed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile char adc_chan1_on</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>whether or not the middle note is held down. </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00038">38</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a738c7d0b67ff439a2c81556a6e27a0b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t base_note = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>base_note for transposing the C-major scale </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00142">142</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="adf5dc5d7c17abd6f7cd1c83d7bf7b80b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile char chan1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project_8c_source.html#l00034">34</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="abd7697134589aaeaa645826770a848dd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char channel = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project_8c_source.html#l00071">71</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac11cb4dad0b6ed87a539bacb6d2199ab"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char cmajor[15] = {48, 50, 52, 53, 55, 57, 59, 60, 62, 64, 65, 67, 69, 71, 72}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>C-major scale in MIDI notes can add or subtract a value to transpose to different keys. </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00203">203</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6ef35889f75ea54ee11bb86aa6e050fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t instrument = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>counter to keep track of what instrument is on the MIDI channel </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00134">134</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7c8d1e48e7d9348b930a7e7bc4d610a1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t note = 60</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Current note being played. </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00138">138</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a99e594c637ddc152c7bdd011c3e3230a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float old_roll</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>used to keep track of the roll so we can bend the pitch relative to the note it was played at. </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00153">153</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2870b94aac38e021ccd11ec0bc3b3952"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char play_off = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>if 0 a note is turned off </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00028">28</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a1a106c21f35394486c40bed04ae4aaa2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char play_on = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>if 1 a note is played </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00024">24</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a93658cf9f03a3303cdb292e655c657e7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t time = 0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project_8c_source.html#l00143">143</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a059effc655ee0c23238a50c5ae5369cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">volatile unsigned int time1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>task1 counter </p>

<p>Definition at line <a class="el" href="project_8c_source.html#l00042">42</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="a14798c028401767ed27eed7a06030295"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">FILE uart_str = FDEV_SETUP_STREAM(<a class="el" href="uart_8h.html#a985ba70f2a53d95f1fd11f70f1d8f4f6">uart_putchar</a>, <a class="el" href="uart_8h.html#ae29d6eea5f2e7997551b4acb64082d8e">uart_getchar</a>, _FDEV_SETUP_RW)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project_8c_source.html#l00014">14</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
<a class="anchor" id="aff3f4500e2ca9497ec093a0e2d69e7e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t wait = <a class="el" href="project_8c.html#a667e4a328965fc2fc25f1533a00ec89f">WAIT_VALUE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="project_8c_source.html#l00147">147</a> of file <a class="el" href="project_8c_source.html">project.c</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 10 2014 16:33:34 for ECE 4760 Final Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
