<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>ECE 4760 Final Project: src/project.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ECE 4760 Final Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">project.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="project_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// This pgm just blinks D.2 for testing the protoboard.</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;inttypes.h&gt;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;avr/io.h&gt;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;avr/interrupt.h&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="imu_8h.html">imu.h</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;util/delay.h&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="midi_8h.html">midi.h</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// serial communication library</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="uart_8h.html">uart.h</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// UART file descriptor</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// putchar and getchar are in uart.c</span></div>
<div class="line"><a name="l00014"></a><span class="lineno"><a class="line" href="project_8c.html#a14798c028401767ed27eed7a06030295">   14</a></span>&#160;FILE <a class="code" href="project_8c.html#a14798c028401767ed27eed7a06030295">uart_str</a> = FDEV_SETUP_STREAM(<a class="code" href="uart_8c.html#a985ba70f2a53d95f1fd11f70f1d8f4f6">uart_putchar</a>, <a class="code" href="uart_8c.html#ae29d6eea5f2e7997551b4acb64082d8e">uart_getchar</a>, _FDEV_SETUP_RW);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//timeout values for each task</span></div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="project_8c.html#a65f7891fccbfcf7d08964555630773b3">   18</a></span>&#160;<span class="preprocessor">#define t1 25</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">// task subroutines</span><span class="comment"></span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">* @brief if 1 a note is played</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="project_8c.html#a1a106c21f35394486c40bed04ae4aaa2">   24</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="project_8c.html#a1a106c21f35394486c40bed04ae4aaa2">play_on</a> = 0;<span class="comment"></span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">* @brief if 0 a note is turned off</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="project_8c.html#a2870b94aac38e021ccd11ec0bc3b3952">   28</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="project_8c.html#a2870b94aac38e021ccd11ec0bc3b3952">play_off</a> = 0;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keywordtype">void</span> <a class="code" href="project_8c.html#ab55078d807df0a75af8a2fa8eefdcc41">task1</a>(<span class="keywordtype">void</span>);   <span class="comment">//blink at 2 or 8 Hz</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="keywordtype">void</span> <a class="code" href="project_8c.html#a9efe22aaead3a5e936b5df459de02eba">initialize</a>(<span class="keywordtype">void</span>); <span class="comment">//all the usual mcu stuff</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keywordtype">void</span> <a class="code" href="project_8c.html#abe65b6407e326820d3a507f8ba85367f">get_pitch_roll</a>(<span class="keywordtype">float</span> *pitch, <span class="keywordtype">float</span> *roll);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keywordtype">void</span> <a class="code" href="project_8c.html#a35c74421f01d5b088b0919fe9fe4abd0">play_note_off</a>(<span class="keywordtype">void</span>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keywordtype">void</span> <a class="code" href="project_8c.html#aeebc67746187224a86dcf54613f612b5">play_note_on</a>(uint8_t y);</div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="project_8c.html#adf5dc5d7c17abd6f7cd1c83d7bf7b80b">   34</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">char</span> <a class="code" href="project_8c.html#adf5dc5d7c17abd6f7cd1c83d7bf7b80b">chan1</a>;<span class="comment"></span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">* @brief whether or not the middle note is held down.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="project_8c.html#a4b4b739b9230f7463316669ac39ddbed">   38</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">char</span> <a class="code" href="project_8c.html#a4b4b739b9230f7463316669ac39ddbed">adc_chan1_on</a>;<span class="comment"></span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">* @brief task1 counter</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="project_8c.html#a059effc655ee0c23238a50c5ae5369cb">   42</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="project_8c.html#a059effc655ee0c23238a50c5ae5369cb">time1</a>; <span class="comment">//timeout counter</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//**********************************************************</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//timer 0 compare ISR</span><span class="comment"></span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * @brief This ISR keeps a millisecond timer for timing the main task.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="project_8c.html#aec43762dc86e029b395d4e5819192c2d">   50</a></span>&#160;<a class="code" href="project_8c.html#aec43762dc86e029b395d4e5819192c2d">ISR</a> (TIMER0_COMPA_vect)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="comment">//Decrement the  time if they are not already zero</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="project_8c.html#a059effc655ee0c23238a50c5ae5369cb">time1</a>&gt;0)  --<a class="code" href="project_8c.html#a059effc655ee0c23238a50c5ae5369cb">time1</a>;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;}</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">//**********************************************************</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> *Entry point and task scheduler loop</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="project_8c.html#a840291bc02cba5474a4cb46a9b9566fe">   62</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="project_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;{</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="project_8c.html#a9efe22aaead3a5e936b5df459de02eba">initialize</a>();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="comment">//main task scheduler loop</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">while</span>(1)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="project_8c.html#a059effc655ee0c23238a50c5ae5369cb">time1</a>==0){<a class="code" href="project_8c.html#a059effc655ee0c23238a50c5ae5369cb">time1</a>=<a class="code" href="project_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>; <a class="code" href="project_8c.html#ab55078d807df0a75af8a2fa8eefdcc41">task1</a>();}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  }</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="project_8c.html#abd7697134589aaeaa645826770a848dd">   71</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="project_8c.html#abd7697134589aaeaa645826770a848dd">channel</a> = 0;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> * @brief Rather than waiting in while loop for the ADC readings, we use the ADC interupt that sets the values asynchronously.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"> * This function checks to see if the values of the flex resistors have indicted whether a finger has been bent or not. If the</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"> * value of Chanel 0 of the ADC is greater than 250 we set a flag to play a note, if it is less than 245, we set a flag to end</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"> * the note. The other flex resitor, on the middle finger has a larger range so determining whether it is on or off is easier,</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"> * we merely check to see if it is greater than 240, and set the appropiate flag.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="project_8c.html#a05c2e5b588ced1cd7312f5b0edc5b295">   81</a></span>&#160;<a class="code" href="project_8c.html#aec43762dc86e029b395d4e5819192c2d">ISR</a>(ADC_vect) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  uint8_t analog = ADCH;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="project_8c.html#abd7697134589aaeaa645826770a848dd">channel</a> == 0) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">if</span> (analog &gt; 250 &amp;&amp; !<a class="code" href="project_8c.html#adf5dc5d7c17abd6f7cd1c83d7bf7b80b">chan1</a>) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      <a class="code" href="project_8c.html#a1a106c21f35394486c40bed04ae4aaa2">play_on</a> = 1;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      <a class="code" href="project_8c.html#adf5dc5d7c17abd6f7cd1c83d7bf7b80b">chan1</a>= 1;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <span class="keywordflow">if</span> (analog &lt; 245 &amp;&amp; <a class="code" href="project_8c.html#adf5dc5d7c17abd6f7cd1c83d7bf7b80b">chan1</a>) {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <a class="code" href="project_8c.html#adf5dc5d7c17abd6f7cd1c83d7bf7b80b">chan1</a> = 0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      <a class="code" href="project_8c.html#a2870b94aac38e021ccd11ec0bc3b3952">play_off</a> = 1;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    }</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    ADMUX |= (1&lt;&lt;MUX0);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    ADCSRA |= (1&lt;&lt;ADSC);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <a class="code" href="project_8c.html#abd7697134589aaeaa645826770a848dd">channel</a> = 1;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="project_8c.html#abd7697134589aaeaa645826770a848dd">channel</a> == 1) {</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    ADMUX &amp;= ~(1&lt;&lt;MUX0);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <span class="keywordflow">if</span> (analog &gt; 240) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;      <a class="code" href="project_8c.html#a4b4b739b9230f7463316669ac39ddbed">adc_chan1_on</a> = 1;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      <a class="code" href="project_8c.html#a4b4b739b9230f7463316669ac39ddbed">adc_chan1_on</a> = 0;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <a class="code" href="project_8c.html#abd7697134589aaeaa645826770a848dd">channel</a> = 0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;}</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">//**********************************************************</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> * @brief This function reads the accelerometer and calculates the pitch and roll of the device.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> * @param pitch pointer to a float that will contain the current pitch measured by the accelerometer.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> * @param roll pointer to a float that will contain the current roll measured by the accelerometer.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="project_8c.html#abe65b6407e326820d3a507f8ba85367f">  120</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="project_8c.html#abe65b6407e326820d3a507f8ba85367f">get_pitch_roll</a>(<span class="keywordtype">float</span> *pitch, <span class="keywordtype">float</span> *roll) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordtype">float</span> x,y,z;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="imu_8c.html#a57a50fc0cf47e57a195b0235e1086336">read_accel</a>(&amp;x,&amp;y,&amp;z);</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  *pitch = atan2(x, sqrt((y * y) + (z * z)));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  *roll = atan2(y, sqrt((x * x) + (z * z)));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  *pitch *= 180.0 / M_PI;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  *roll *= 180.0 / M_PI;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;}</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">* @brief counter to keep track of what instrument is on the MIDI channel </span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="project_8c.html#a6ef35889f75ea54ee11bb86aa6e050fd">  134</a></span>&#160;uint8_t <a class="code" href="project_8c.html#a6ef35889f75ea54ee11bb86aa6e050fd">instrument</a> = 0;<span class="comment"></span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">* @brief Current note being played</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="project_8c.html#a7c8d1e48e7d9348b930a7e7bc4d610a1">  138</a></span>&#160;uint8_t <a class="code" href="project_8c.html#a7c8d1e48e7d9348b930a7e7bc4d610a1">note</a> = 60;<span class="comment"></span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">* @brief base_note for transposing the C-major scale</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="project_8c.html#a738c7d0b67ff439a2c81556a6e27a0b1">  142</a></span>&#160;uint8_t <a class="code" href="project_8c.html#a738c7d0b67ff439a2c81556a6e27a0b1">base_note</a> = 0;</div>
<div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="project_8c.html#a93658cf9f03a3303cdb292e655c657e7">  143</a></span>&#160;uint16_t <a class="code" href="project_8c.html#a93658cf9f03a3303cdb292e655c657e7">time</a> = 0;</div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="project_8c.html#a667e4a328965fc2fc25f1533a00ec89f">  144</a></span>&#160;<span class="preprocessor">#define WAIT_VALUE (300 / t1)</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="project_8c.html#ab4df97ec55e2ff0a866d4681bf326a40">  145</a></span>&#160;<span class="preprocessor">#define RATE_THRES (240)</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">  147</a></span>&#160;uint16_t <a class="code" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a> = <a class="code" href="project_8c.html#a667e4a328965fc2fc25f1533a00ec89f">WAIT_VALUE</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="keywordtype">char</span> <a class="code" href="project_8c.html#a4ef6c44503e9e5e255ef3c7847c7f7ad">handle_notes</a>(<span class="keywordtype">float</span>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">* @brief used to keep track of the roll so we can bend the pitch relative to the note it was played at.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="project_8c.html#a99e594c637ddc152c7bdd011c3e3230a">  153</a></span>&#160;<span class="keywordtype">float</span> <a class="code" href="project_8c.html#a99e594c637ddc152c7bdd011c3e3230a">old_roll</a>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> * @brief This function is the function that gets called every 25ms that handles the main logic, it reads the sensor values, checks flags set by the</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> * ADC interrupt vector, and sends the according MIDI signals.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00159"></a><span class="lineno"><a class="line" href="project_8c.html#ab55078d807df0a75af8a2fa8eefdcc41">  159</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="project_8c.html#ab55078d807df0a75af8a2fa8eefdcc41">task1</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  ADCSRA |= (1&lt;&lt;ADSC);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <span class="keywordtype">float</span> x,y,z;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="keywordtype">float</span> roll,pitch;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <a class="code" href="project_8c.html#abe65b6407e326820d3a507f8ba85367f">get_pitch_roll</a>(&amp;pitch,&amp;roll);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">//Save the old roll if we play a new note so we don&#39;t bend the note too much.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="project_8c.html#a4ef6c44503e9e5e255ef3c7847c7f7ad">handle_notes</a>(roll)) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="project_8c.html#a99e594c637ddc152c7bdd011c3e3230a">old_roll</a> = roll;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">// bend the pitch if the middle finger is down.</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="project_8c.html#adf5dc5d7c17abd6f7cd1c83d7bf7b80b">chan1</a> &amp;&amp; <a class="code" href="project_8c.html#a4b4b739b9230f7463316669ac39ddbed">adc_chan1_on</a>) {</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    roll -= <a class="code" href="project_8c.html#a99e594c637ddc152c7bdd011c3e3230a">old_roll</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    roll/=90.0;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    roll*=2000;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="midi_8c.html#ad2b2df86df356c1d2f74729adec23655">pitch_bend</a>(2,(2000+((int16_t)roll))&lt;&lt;2);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="imu_8c.html#ad7e96d96817783a80d0d4236f7e691c1">read_gyro</a>(&amp;x,&amp;y,&amp;z);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="comment">// We don&#39;t want to change the instrument or key too often</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a>) <a class="code" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a>--;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="keywordflow">if</span> (x &gt; <a class="code" href="project_8c.html#ab4df97ec55e2ff0a866d4681bf326a40">RATE_THRES</a>  &amp;&amp; !<a class="code" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a>) {</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <a class="code" href="project_8c.html#a6ef35889f75ea54ee11bb86aa6e050fd">instrument</a>++;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <a class="code" href="midi_8c.html#a2c6e7a520636854483abb55b0a9141a1">change_instrument</a>(2,<a class="code" href="project_8c.html#a6ef35889f75ea54ee11bb86aa6e050fd">instrument</a>%128);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <a class="code" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a> = <a class="code" href="project_8c.html#a667e4a328965fc2fc25f1533a00ec89f">WAIT_VALUE</a>;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x&lt;-<a class="code" href="project_8c.html#ab4df97ec55e2ff0a866d4681bf326a40">RATE_THRES</a> &amp;&amp; !<a class="code" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a>) {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a> = <a class="code" href="project_8c.html#a667e4a328965fc2fc25f1533a00ec89f">WAIT_VALUE</a>;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <a class="code" href="project_8c.html#a6ef35889f75ea54ee11bb86aa6e050fd">instrument</a>--;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <a class="code" href="midi_8c.html#a2c6e7a520636854483abb55b0a9141a1">change_instrument</a>(2,<a class="code" href="project_8c.html#a6ef35889f75ea54ee11bb86aa6e050fd">instrument</a>%128);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(y &gt; <a class="code" href="project_8c.html#ab4df97ec55e2ff0a866d4681bf326a40">RATE_THRES</a> &amp;&amp; !<a class="code" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a>) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a> = <a class="code" href="project_8c.html#a667e4a328965fc2fc25f1533a00ec89f">WAIT_VALUE</a>;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <a class="code" href="project_8c.html#a738c7d0b67ff439a2c81556a6e27a0b1">base_note</a> -= 1;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(y &lt; -<a class="code" href="project_8c.html#ab4df97ec55e2ff0a866d4681bf326a40">RATE_THRES</a> &amp;&amp; !<a class="code" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a>) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <a class="code" href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a> = <a class="code" href="project_8c.html#a667e4a328965fc2fc25f1533a00ec89f">WAIT_VALUE</a>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <a class="code" href="project_8c.html#a738c7d0b67ff439a2c81556a6e27a0b1">base_note</a> += 1;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  }</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}<span class="comment"></span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">* @brief C-major scale in MIDI notes can add or subtract a value to transpose to different keys</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00203"></a><span class="lineno"><a class="line" href="project_8c.html#ac11cb4dad0b6ed87a539bacb6d2199ab">  203</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="project_8c.html#ac11cb4dad0b6ed87a539bacb6d2199ab">cmajor</a>[15] = {48, 50, 52, 53, 55, 57, 59, 60, 62, 64, 65, 67, 69, 71, 72};<span class="comment"></span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">* @brief Takes the current roll and determines if a note needs to be played or turned off. It calculates the note from the roll. We are playing notes only on a major scale. It can be transposed up or down.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">* @param roll - roll of the glove</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">* @return 1 if a new note was played, 0 otherwise</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="project_8c.html#a4ef6c44503e9e5e255ef3c7847c7f7ad">  211</a></span>&#160;<span class="keywordtype">char</span> <a class="code" href="project_8c.html#a4ef6c44503e9e5e255ef3c7847c7f7ad">handle_notes</a>(<span class="keywordtype">float</span> roll)</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;{</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  int8_t sharp = 0;</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="project_8c.html#a4b4b739b9230f7463316669ac39ddbed">adc_chan1_on</a>) {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    sharp = 1;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  }</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="project_8c.html#a1a106c21f35394486c40bed04ae4aaa2">play_on</a>) {</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="keywordtype">float</span> froll = roll;</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    froll /= 90.0;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    froll *= 7;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    int8_t iroll = (int8_t)froll;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    iroll += 8;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <a class="code" href="project_8c.html#aeebc67746187224a86dcf54613f612b5">play_note_on</a>(<a class="code" href="project_8c.html#a738c7d0b67ff439a2c81556a6e27a0b1">base_note</a>+<a class="code" href="project_8c.html#ac11cb4dad0b6ed87a539bacb6d2199ab">cmajor</a>[iroll]);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    PORTD |= (1&lt;&lt;PD2);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="project_8c.html#a1a106c21f35394486c40bed04ae4aaa2">play_on</a> = 0;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  }<span class="keywordflow">else</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="project_8c.html#a2870b94aac38e021ccd11ec0bc3b3952">play_off</a>) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <a class="code" href="project_8c.html#a35c74421f01d5b088b0919fe9fe4abd0">play_note_off</a>();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      PORTD &amp;= ~(1&lt;&lt;PD2);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      <a class="code" href="project_8c.html#a2870b94aac38e021ccd11ec0bc3b3952">play_off</a> = 0;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    }</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;}</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">* @brief Sends the MIDI note on signal on the serial line with the note specified in the parameter at velocity 100.</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">* stores the note in a global variable so we can turn it off at a later time.</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">*</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">* @param n - note to play.</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00243"></a><span class="lineno"><a class="line" href="project_8c.html#aeebc67746187224a86dcf54613f612b5">  243</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="project_8c.html#aeebc67746187224a86dcf54613f612b5">play_note_on</a>(uint8_t n) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  <a class="code" href="project_8c.html#a7c8d1e48e7d9348b930a7e7bc4d610a1">note</a> =(uint8_t)n;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <a class="code" href="midi_8c.html#a1d1ffb6c80a33cb1a9943cc6b145e6c2">send_note</a>(2,100,<a class="code" href="project_8c.html#a7c8d1e48e7d9348b930a7e7bc4d610a1">note</a>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;}</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"></span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">* @brief Turns the note we had stored in the note global varible off.</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00253"></a><span class="lineno"><a class="line" href="project_8c.html#a35c74421f01d5b088b0919fe9fe4abd0">  253</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="project_8c.html#a35c74421f01d5b088b0919fe9fe4abd0">play_note_off</a>(<span class="keywordtype">void</span>) {</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <a class="code" href="midi_8c.html#ad6a560f23d307c8375badcbf73ac0eab">send_note_off</a>(2,100,<a class="code" href="project_8c.html#a7c8d1e48e7d9348b930a7e7bc4d610a1">note</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">//**********************************************************</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">//Set it all up</span></div>
<div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="project_8c.html#a9efe22aaead3a5e936b5df459de02eba">  261</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="project_8c.html#a9efe22aaead3a5e936b5df459de02eba">initialize</a>(<span class="keywordtype">void</span>)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;{</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <span class="comment">//set up the LED port</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  DDRD = (1&lt;&lt;PD2) ;  <span class="comment">// PORT D.2 is an ouput</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  PORTD &amp;= ~(1&lt;&lt;PD2);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <span class="comment">//set up timer 0 for 1 mSec timebase</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  TIMSK0= (1&lt;&lt;OCIE0A);  <span class="comment">//turn on timer 0 cmp match ISR</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  OCR0A = 249;      <span class="comment">//set the compare register to 250 time ticks</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <span class="comment">//set prescalar to divide by 64</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  TCCR0B= 3;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="comment">// turn on clear-on-match</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  TCCR0A= (1&lt;&lt;WGM01) ;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <span class="comment">//init the task timer</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <a class="code" href="project_8c.html#a059effc655ee0c23238a50c5ae5369cb">time1</a>=<a class="code" href="project_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">//init the UART -- uart_init() is in uart.c</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="uart_8c.html#a0c0ca72359ddf28dcd15900dfba19343">uart_init</a>();</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  stdout = stdin = stderr = &amp;<a class="code" href="project_8c.html#a14798c028401767ed27eed7a06030295">uart_str</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  ADMUX = (1&lt;&lt;ADLAR) | (1&lt;&lt;REFS0);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  ADCSRA = (1&lt;&lt;ADEN) | (1&lt;&lt;ADIF) | (1&lt;&lt;ADIE) + 7;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  sei();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="imu_8c.html#ae0dd860772a2887183a0c74a8a2b8b20">init_imu</a>(<a class="code" href="imu_8h.html#aaefcfc776c48cc3dadde638a460a41f7afad4e9baa5094130c2bc658eb246bf28">G_SCALE_245DPS</a>, <a class="code" href="imu_8h.html#a673b4d5fae609f3439299512239f16d5a9f13a7adb3d15b6f7fde45dbad3cad79">A_SCALE_2G</a>, <a class="code" href="imu_8h.html#a84f71ddfd863e44aed142156f8314f12ad03d84f083ecdbea45e7ce9182b13b0d">M_SCALE_2GS</a>, <a class="code" href="imu_8h.html#af4749d8ab55f522c4ec64885dfd5b0daad0ce3f8314e38d8b4a79024fa5c99ba9">G_ODR_95_BW_125</a>,<a class="code" href="imu_8h.html#a0fa3cd8bd1e1395c6f4b7d122e568a4ca97293d2dc6c297f6cea43a223243386b">A_ODR_50</a>, <a class="code" href="imu_8h.html#a766d6813f2dbc4e79cd5491bf8cffba1a054c9a0274ad98679b7e98e2714293f0">M_ODR_50</a>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="comment">// 1600 Hz (0xA)</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <span class="comment">//crank up the ISRs</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  ADCSRA |= (1&lt;&lt;ADSC);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;}</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div>
<div class="ttc" id="imu_8h_html_aaefcfc776c48cc3dadde638a460a41f7afad4e9baa5094130c2bc658eb246bf28"><div class="ttname"><a href="imu_8h.html#aaefcfc776c48cc3dadde638a460a41f7afad4e9baa5094130c2bc658eb246bf28">G_SCALE_245DPS</a></div><div class="ttdef"><b>Definition:</b> <a href="imu_8h_source.html#l00110">imu.h:110</a></div></div>
<div class="ttc" id="project_8c_html_a6ef35889f75ea54ee11bb86aa6e050fd"><div class="ttname"><a href="project_8c.html#a6ef35889f75ea54ee11bb86aa6e050fd">instrument</a></div><div class="ttdeci">uint8_t instrument</div><div class="ttdoc">counter to keep track of what instrument is on the MIDI channel </div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00134">project.c:134</a></div></div>
<div class="ttc" id="project_8c_html_aff3f4500e2ca9497ec093a0e2d69e7e9"><div class="ttname"><a href="project_8c.html#aff3f4500e2ca9497ec093a0e2d69e7e9">wait</a></div><div class="ttdeci">uint16_t wait</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00147">project.c:147</a></div></div>
<div class="ttc" id="uart_8h_html"><div class="ttname"><a href="uart_8h.html">uart.h</a></div></div>
<div class="ttc" id="project_8c_html_a059effc655ee0c23238a50c5ae5369cb"><div class="ttname"><a href="project_8c.html#a059effc655ee0c23238a50c5ae5369cb">time1</a></div><div class="ttdeci">volatile unsigned int time1</div><div class="ttdoc">task1 counter </div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00042">project.c:42</a></div></div>
<div class="ttc" id="project_8c_html_a14798c028401767ed27eed7a06030295"><div class="ttname"><a href="project_8c.html#a14798c028401767ed27eed7a06030295">uart_str</a></div><div class="ttdeci">FILE uart_str</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00014">project.c:14</a></div></div>
<div class="ttc" id="uart_8c_html_a0c0ca72359ddf28dcd15900dfba19343"><div class="ttname"><a href="uart_8c.html#a0c0ca72359ddf28dcd15900dfba19343">uart_init</a></div><div class="ttdeci">void uart_init(void)</div><div class="ttdef"><b>Definition:</b> <a href="uart_8c_source.html#l00035">uart.c:35</a></div></div>
<div class="ttc" id="project_8c_html_abe65b6407e326820d3a507f8ba85367f"><div class="ttname"><a href="project_8c.html#abe65b6407e326820d3a507f8ba85367f">get_pitch_roll</a></div><div class="ttdeci">void get_pitch_roll(float *pitch, float *roll)</div><div class="ttdoc">This function reads the accelerometer and calculates the pitch and roll of the device. </div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00120">project.c:120</a></div></div>
<div class="ttc" id="project_8c_html_a65f7891fccbfcf7d08964555630773b3"><div class="ttname"><a href="project_8c.html#a65f7891fccbfcf7d08964555630773b3">t1</a></div><div class="ttdeci">#define t1</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00018">project.c:18</a></div></div>
<div class="ttc" id="project_8c_html_a2870b94aac38e021ccd11ec0bc3b3952"><div class="ttname"><a href="project_8c.html#a2870b94aac38e021ccd11ec0bc3b3952">play_off</a></div><div class="ttdeci">char play_off</div><div class="ttdoc">if 0 a note is turned off </div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00028">project.c:28</a></div></div>
<div class="ttc" id="project_8c_html_abd7697134589aaeaa645826770a848dd"><div class="ttname"><a href="project_8c.html#abd7697134589aaeaa645826770a848dd">channel</a></div><div class="ttdeci">char channel</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00071">project.c:71</a></div></div>
<div class="ttc" id="project_8c_html_a4ef6c44503e9e5e255ef3c7847c7f7ad"><div class="ttname"><a href="project_8c.html#a4ef6c44503e9e5e255ef3c7847c7f7ad">handle_notes</a></div><div class="ttdeci">char handle_notes(float)</div><div class="ttdoc">Takes the current roll and determines if a note needs to be played or turned off. It calculates the n...</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00211">project.c:211</a></div></div>
<div class="ttc" id="imu_8h_html_a673b4d5fae609f3439299512239f16d5a9f13a7adb3d15b6f7fde45dbad3cad79"><div class="ttname"><a href="imu_8h.html#a673b4d5fae609f3439299512239f16d5a9f13a7adb3d15b6f7fde45dbad3cad79">A_SCALE_2G</a></div><div class="ttdef"><b>Definition:</b> <a href="imu_8h_source.html#l00117">imu.h:117</a></div></div>
<div class="ttc" id="midi_8c_html_ad2b2df86df356c1d2f74729adec23655"><div class="ttname"><a href="midi_8c.html#ad2b2df86df356c1d2f74729adec23655">pitch_bend</a></div><div class="ttdeci">void pitch_bend(uint8_t channel, int16_t value)</div><div class="ttdef"><b>Definition:</b> <a href="midi_8c_source.html#l00029">midi.c:29</a></div></div>
<div class="ttc" id="project_8c_html_ab4df97ec55e2ff0a866d4681bf326a40"><div class="ttname"><a href="project_8c.html#ab4df97ec55e2ff0a866d4681bf326a40">RATE_THRES</a></div><div class="ttdeci">#define RATE_THRES</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00145">project.c:145</a></div></div>
<div class="ttc" id="imu_8h_html_a766d6813f2dbc4e79cd5491bf8cffba1a054c9a0274ad98679b7e98e2714293f0"><div class="ttname"><a href="imu_8h.html#a766d6813f2dbc4e79cd5491bf8cffba1a054c9a0274ad98679b7e98e2714293f0">M_ODR_50</a></div><div class="ttdef"><b>Definition:</b> <a href="imu_8h_source.html#l00183">imu.h:183</a></div></div>
<div class="ttc" id="midi_8h_html"><div class="ttname"><a href="midi_8h.html">midi.h</a></div></div>
<div class="ttc" id="uart_8c_html_a985ba70f2a53d95f1fd11f70f1d8f4f6"><div class="ttname"><a href="uart_8c.html#a985ba70f2a53d95f1fd11f70f1d8f4f6">uart_putchar</a></div><div class="ttdeci">int uart_putchar(char c, FILE *stream)</div><div class="ttdef"><b>Definition:</b> <a href="uart_8c_source.html#l00051">uart.c:51</a></div></div>
<div class="ttc" id="project_8c_html_a99e594c637ddc152c7bdd011c3e3230a"><div class="ttname"><a href="project_8c.html#a99e594c637ddc152c7bdd011c3e3230a">old_roll</a></div><div class="ttdeci">float old_roll</div><div class="ttdoc">used to keep track of the roll so we can bend the pitch relative to the note it was played at...</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00153">project.c:153</a></div></div>
<div class="ttc" id="project_8c_html_adf5dc5d7c17abd6f7cd1c83d7bf7b80b"><div class="ttname"><a href="project_8c.html#adf5dc5d7c17abd6f7cd1c83d7bf7b80b">chan1</a></div><div class="ttdeci">volatile char chan1</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00034">project.c:34</a></div></div>
<div class="ttc" id="imu_8h_html_af4749d8ab55f522c4ec64885dfd5b0daad0ce3f8314e38d8b4a79024fa5c99ba9"><div class="ttname"><a href="imu_8h.html#af4749d8ab55f522c4ec64885dfd5b0daad0ce3f8314e38d8b4a79024fa5c99ba9">G_ODR_95_BW_125</a></div><div class="ttdef"><b>Definition:</b> <a href="imu_8h_source.html#l00134">imu.h:134</a></div></div>
<div class="ttc" id="project_8c_html_a35c74421f01d5b088b0919fe9fe4abd0"><div class="ttname"><a href="project_8c.html#a35c74421f01d5b088b0919fe9fe4abd0">play_note_off</a></div><div class="ttdeci">void play_note_off(void)</div><div class="ttdoc">Turns the note we had stored in the note global varible off. </div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00253">project.c:253</a></div></div>
<div class="ttc" id="project_8c_html_a667e4a328965fc2fc25f1533a00ec89f"><div class="ttname"><a href="project_8c.html#a667e4a328965fc2fc25f1533a00ec89f">WAIT_VALUE</a></div><div class="ttdeci">#define WAIT_VALUE</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00144">project.c:144</a></div></div>
<div class="ttc" id="project_8c_html_aeebc67746187224a86dcf54613f612b5"><div class="ttname"><a href="project_8c.html#aeebc67746187224a86dcf54613f612b5">play_note_on</a></div><div class="ttdeci">void play_note_on(uint8_t y)</div><div class="ttdoc">Sends the MIDI note on signal on the serial line with the note specified in the parameter at velocity...</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00243">project.c:243</a></div></div>
<div class="ttc" id="project_8c_html_a7c8d1e48e7d9348b930a7e7bc4d610a1"><div class="ttname"><a href="project_8c.html#a7c8d1e48e7d9348b930a7e7bc4d610a1">note</a></div><div class="ttdeci">uint8_t note</div><div class="ttdoc">Current note being played. </div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00138">project.c:138</a></div></div>
<div class="ttc" id="imu_8h_html_a84f71ddfd863e44aed142156f8314f12ad03d84f083ecdbea45e7ce9182b13b0d"><div class="ttname"><a href="imu_8h.html#a84f71ddfd863e44aed142156f8314f12ad03d84f083ecdbea45e7ce9182b13b0d">M_SCALE_2GS</a></div><div class="ttdef"><b>Definition:</b> <a href="imu_8h_source.html#l00126">imu.h:126</a></div></div>
<div class="ttc" id="uart_8c_html_ae29d6eea5f2e7997551b4acb64082d8e"><div class="ttname"><a href="uart_8c.html#ae29d6eea5f2e7997551b4acb64082d8e">uart_getchar</a></div><div class="ttdeci">int uart_getchar(FILE *stream)</div><div class="ttdef"><b>Definition:</b> <a href="uart_8c_source.html#l00102">uart.c:102</a></div></div>
<div class="ttc" id="project_8c_html_a1a106c21f35394486c40bed04ae4aaa2"><div class="ttname"><a href="project_8c.html#a1a106c21f35394486c40bed04ae4aaa2">play_on</a></div><div class="ttdeci">char play_on</div><div class="ttdoc">if 1 a note is played </div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00024">project.c:24</a></div></div>
<div class="ttc" id="imu_8h_html"><div class="ttname"><a href="imu_8h.html">imu.h</a></div></div>
<div class="ttc" id="project_8c_html_aec43762dc86e029b395d4e5819192c2d"><div class="ttname"><a href="project_8c.html#aec43762dc86e029b395d4e5819192c2d">ISR</a></div><div class="ttdeci">ISR(TIMER0_COMPA_vect)</div><div class="ttdoc">This ISR keeps a millisecond timer for timing the main task. </div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00050">project.c:50</a></div></div>
<div class="ttc" id="imu_8h_html_a0fa3cd8bd1e1395c6f4b7d122e568a4ca97293d2dc6c297f6cea43a223243386b"><div class="ttname"><a href="imu_8h.html#a0fa3cd8bd1e1395c6f4b7d122e568a4ca97293d2dc6c297f6cea43a223243386b">A_ODR_50</a></div><div class="ttdef"><b>Definition:</b> <a href="imu_8h_source.html#l00158">imu.h:158</a></div></div>
<div class="ttc" id="project_8c_html_a9efe22aaead3a5e936b5df459de02eba"><div class="ttname"><a href="project_8c.html#a9efe22aaead3a5e936b5df459de02eba">initialize</a></div><div class="ttdeci">void initialize(void)</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00261">project.c:261</a></div></div>
<div class="ttc" id="imu_8c_html_ae0dd860772a2887183a0c74a8a2b8b20"><div class="ttname"><a href="imu_8c.html#ae0dd860772a2887183a0c74a8a2b8b20">init_imu</a></div><div class="ttdeci">uint16_t init_imu(enum gyro_scale gScl, enum accel_scale aScl, enum mag_scale mScl, enum gyro_odr gODR, enum accel_odr aODR, enum mag_odr mODR)</div><div class="ttdoc">Initilizes the IMU and enables all 9 axes and set the respective scales and data rates. </div><div class="ttdef"><b>Definition:</b> <a href="imu_8c_source.html#l00032">imu.c:32</a></div></div>
<div class="ttc" id="imu_8c_html_ad7e96d96817783a80d0d4236f7e691c1"><div class="ttname"><a href="imu_8c.html#ad7e96d96817783a80d0d4236f7e691c1">read_gyro</a></div><div class="ttdeci">void read_gyro(float *x, float *y, float *z)</div><div class="ttdoc">Reads the gyroscope and calculates the real value from the raw reading. </div><div class="ttdef"><b>Definition:</b> <a href="imu_8c_source.html#l00233">imu.c:233</a></div></div>
<div class="ttc" id="midi_8c_html_a2c6e7a520636854483abb55b0a9141a1"><div class="ttname"><a href="midi_8c.html#a2c6e7a520636854483abb55b0a9141a1">change_instrument</a></div><div class="ttdeci">void change_instrument(uint8_t channel, uint8_t instrument)</div><div class="ttdef"><b>Definition:</b> <a href="midi_8c_source.html#l00037">midi.c:37</a></div></div>
<div class="ttc" id="project_8c_html_a93658cf9f03a3303cdb292e655c657e7"><div class="ttname"><a href="project_8c.html#a93658cf9f03a3303cdb292e655c657e7">time</a></div><div class="ttdeci">uint16_t time</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00143">project.c:143</a></div></div>
<div class="ttc" id="project_8c_html_ab55078d807df0a75af8a2fa8eefdcc41"><div class="ttname"><a href="project_8c.html#ab55078d807df0a75af8a2fa8eefdcc41">task1</a></div><div class="ttdeci">void task1(void)</div><div class="ttdoc">This function is the function that gets called every 25ms that handles the main logic, it reads the sensor values, checks flags set by the ADC interrupt vector, and sends the according MIDI signals. </div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00159">project.c:159</a></div></div>
<div class="ttc" id="midi_8c_html_a1d1ffb6c80a33cb1a9943cc6b145e6c2"><div class="ttname"><a href="midi_8c.html#a1d1ffb6c80a33cb1a9943cc6b145e6c2">send_note</a></div><div class="ttdeci">void send_note(uint8_t channel, uint8_t vel, uint8_t pitch)</div><div class="ttdef"><b>Definition:</b> <a href="midi_8c_source.html#l00052">midi.c:52</a></div></div>
<div class="ttc" id="project_8c_html_a840291bc02cba5474a4cb46a9b9566fe"><div class="ttname"><a href="project_8c.html#a840291bc02cba5474a4cb46a9b9566fe">main</a></div><div class="ttdeci">int main(void)</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00062">project.c:62</a></div></div>
<div class="ttc" id="project_8c_html_a4b4b739b9230f7463316669ac39ddbed"><div class="ttname"><a href="project_8c.html#a4b4b739b9230f7463316669ac39ddbed">adc_chan1_on</a></div><div class="ttdeci">volatile char adc_chan1_on</div><div class="ttdoc">whether or not the middle note is held down. </div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00038">project.c:38</a></div></div>
<div class="ttc" id="imu_8c_html_a57a50fc0cf47e57a195b0235e1086336"><div class="ttname"><a href="imu_8c.html#a57a50fc0cf47e57a195b0235e1086336">read_accel</a></div><div class="ttdeci">void read_accel(float *x, float *y, float *z)</div><div class="ttdoc">Reads the accelometer and calculates the real value from the raw reading. </div><div class="ttdef"><b>Definition:</b> <a href="imu_8c_source.html#l00241">imu.c:241</a></div></div>
<div class="ttc" id="project_8c_html_ac11cb4dad0b6ed87a539bacb6d2199ab"><div class="ttname"><a href="project_8c.html#ac11cb4dad0b6ed87a539bacb6d2199ab">cmajor</a></div><div class="ttdeci">char cmajor[15]</div><div class="ttdoc">C-major scale in MIDI notes can add or subtract a value to transpose to different keys...</div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00203">project.c:203</a></div></div>
<div class="ttc" id="project_8c_html_a738c7d0b67ff439a2c81556a6e27a0b1"><div class="ttname"><a href="project_8c.html#a738c7d0b67ff439a2c81556a6e27a0b1">base_note</a></div><div class="ttdeci">uint8_t base_note</div><div class="ttdoc">base_note for transposing the C-major scale </div><div class="ttdef"><b>Definition:</b> <a href="project_8c_source.html#l00142">project.c:142</a></div></div>
<div class="ttc" id="midi_8c_html_ad6a560f23d307c8375badcbf73ac0eab"><div class="ttname"><a href="midi_8c.html#ad6a560f23d307c8375badcbf73ac0eab">send_note_off</a></div><div class="ttdeci">void send_note_off(uint8_t channel, uint8_t vel, uint8_t pitch)</div><div class="ttdef"><b>Definition:</b> <a href="midi_8c_source.html#l00058">midi.c:58</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Dec 10 2014 16:33:34 for ECE 4760 Final Project by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
